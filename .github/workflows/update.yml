name: Ping Leetcode API for updates
on:
    schedule:
        - cron: '0,30 * * * *' # every 30 minutes
    push:
        branches:
            - main
jobs:
    build:
        runs-on: ubuntu-latest
        steps:
            - name: Checkout repository
              uses: actions/checkout@v3
              with:
                fetch-depth: 1
            - name: Set up Java 17
              uses: actions/setup-java@v3
              with:
                  distribution: 'temurin'
                  java-version: '17'
            - name: Run UpdateManager
              run: javac UpdateManager/*.java && java -cp UpdateManager Main && cd UpdateManager/ && rm *.class && cd ..
              working-directory: ./ProgressViewer
            - name: Commit and push changes
              run: |
                  git config --global user.name 'github-actions[bot]'
                  git config --global user.email 'github-actions[bot]@users.noreply.github.com'
                  git add .
                  git commit -m 'Update progress data' || echo "No changes to commit"
                  git push origin main